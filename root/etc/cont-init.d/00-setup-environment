#!/usr/bin/with-contenv bash

echo '                                               '
echo '   _________      __  __                       '
echo '  /   _____/__ __|__|/  |______ ______________ '
echo '  \_____  \|  |  \  \   __\__  \\_  __ \_  __ \'
echo '  /        \  |  /  ||  |  / __ \|  | \/|  | \/'
echo ' /_______  /____/|__||__| (____  /__|   |__|   '
echo '         \/                    \/              '
echo '                                               '

echo "
-------------------------------------------
GIVEN ENVIRONMENT
-------------------------------------------
PUID           | $PUID
PGID           | $PGID
UMASK          | $UMASK
APP            | $APP
TZ             | $TZ
BRANCH         | $BRANCH
VERSION        | $VERSION
JACKETT_PROXY  | $JACKETT_PROXY
-------------------------------------------
"

export PUID=${PUID:-1000}
export PGID=${PGID:-1000}
export UMASK=${UMASK:-022}
export APP=${APP:-none}
export TZ=${TZ:-America/New_York}
export BRANCH=${BRANCH:-default}
export VERSION=${VERSION:-default}
export JACKETT_PROXY=${JACKETT_PROXY:-none}

if [[ -f /app.tar.gz ]]; then
    export BRANCH=app.tar.gz
    export VERSION=app.tar.gz
fi

echo "
RUNNING ENVIRONMENT
-------------------------------------------
PUID           | $PUID
PGID           | $PGID
UMASK          | $UMASK
APP            | $APP
TZ             | $TZ
BRANCH         | $BRANCH
VERSION        | $VERSION
JACKETT_PROXY  | $JACKETT_PROXY
-------------------------------------------
"

groupmod -o -g "$PGID" hotio
usermod -o -u "$PUID" hotio
